<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>MG BOT AI ‚Äì Free Smart Trading Signals</title>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
<script src="https://s3.tradingview.com/tv.js"></script>

<style>
:root{
--bg:#020617;
--glass:rgba(255,255,255,.06);
--ai:#00e5ff;
--green:#22c55e;
--red:#ef4444;
--muted:#94a3b8;
--otc:#f59e0b;
}

*{margin:0;padding:0;box-sizing:border-box;font-family:Poppins,Segoe UI,sans-serif}

body{
background:radial-gradient(circle at top,#020617,#000);
color:#e5e5e5;
min-height:100vh;
padding-bottom:100px;
-webkit-tap-highlight-color:transparent;
}

.container{max-width:1200px;margin:auto;padding:16px}

/* HEADER */
.header{text-align:center;padding:20px 10px}
.logo{
display:flex;
justify-content:center;
align-items:center;
gap:14px;
flex-wrap:wrap;
}
.logo-icon{
width:60px;height:60px;border-radius:50%;
background:linear-gradient(135deg,#00e5ff,#3b82f6);
display:flex;align-items:center;justify-content:center;
font-weight:900;font-size:20px;color:#000;
box-shadow:0 0 25px rgba(0,229,255,.7)
}
.logo-text{font-size:28px;font-weight:800}

.ai-badge{
margin:12px auto;
display:inline-flex;
align-items:center;
gap:6px;
padding:8px 18px;
border-radius:25px;
border:1px solid var(--ai);
background:rgba(0,229,255,.15);
color:var(--ai);
font-weight:700;
font-size:13px;
max-width:90%;
}

.free-badge {
    margin: 8px auto;
    display: inline-flex;
    align-items: center;
    gap: 6px;
    padding: 6px 14px;
    border-radius: 20px;
    border: 1px solid #f59e0b;
    background: rgba(245, 158, 11, 0.15);
    color: #fbbf24;
    font-weight: 600;
    font-size: 12px;
    max-width: 90%;
}

.upgrade-notice {
    background: linear-gradient(135deg, #f59e0b, #d97706);
    color: #000;
    padding: 12px;
    border-radius: 12px;
    margin: 15px auto;
    max-width: 600px;
    font-weight: 700;
    font-size: 14px;
    text-align: center;
    border: 1px solid #f59e0b;
}

.sub{
max-width:720px;
margin:auto;
color:var(--muted);
font-size:13px;
line-height:1.6;
padding:0 10px;
}

/* PLATFORM SELECTOR */
.platform-selector {
    text-align: center;
    margin: 30px auto;
    max-width: 600px;
}
.platform-toggle-btn {
    display: inline-flex;
    align-items: center;
    gap: 10px;
    padding: 12px 24px;
    border-radius: 30px;
    background: var(--glass);
    backdrop-filter: blur(14px);
    border: 1px solid rgba(0,229,255,.3);
    color: var(--ai);
    font-weight: 700;
    cursor: pointer;
    transition: all 0.3s ease;
    margin: 0 auto;
}
.platform-toggle-btn:hover {
    background: rgba(0,229,255,.1);
    box-shadow: 0 0 15px rgba(0,229,255,.3);
}
.platform-display {
    display: inline-flex;
    align-items: center;
    gap: 10px;
    padding: 12px 24px;
    border-radius: 30px;
    background: linear-gradient(135deg, #00e5ff, #3b82f6);
    color: #000;
    font-weight: 700;
    margin: 0 auto;
}
.platform-dropdown {
    display: none;
    background: var(--glass);
    backdrop-filter: blur(14px);
    border-radius: 16px;
    padding: 20px;
    border: 1px solid rgba(255,255,255,.08);
    margin-top: 15px;
    text-align: left;
}
.platform-group {
    margin-bottom: 20px;
}
.platform-group:last-child {
    margin-bottom: 0;
}
.platform-group h4 {
    margin-bottom: 12px;
    color: #fff;
    font-size: 15px;
    display: flex;
    align-items: center;
    gap: 8px;
}
.group-buttons {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
}
.plat-btn {
    padding: 10px 18px;
    border-radius: 10px;
    border: 1px solid #334155;
    background: #020617;
    color: #fff;
    font-weight: 600;
    cursor: pointer;
    font-size: 13px;
    transition: all 0.3s ease;
    -webkit-tap-highlight-color:transparent;
}
.plat-btn:hover, .plat-btn.active-plat {
    background: linear-gradient(135deg, #00e5ff, #3b82f6);
    color: #000;
    border: none;
}
@media (max-width: 768px) {
    .group-buttons {
        justify-content: center;
    }
    .plat-btn {
        flex: 1;
        min-width: 100px;
        text-align: center;
    }
}

/* GRID */
.grid{
display:grid;
grid-template-columns:1fr;
gap:14px;
margin-top:20px;
}
@media(min-width:900px){
.grid{grid-template-columns:1fr 1.4fr}
}

/* CARD */
.card{
background:var(--glass);
backdrop-filter:blur(14px);
border-radius:16px;
padding:14px;
border:1px solid rgba(255,255,255,.08);
margin-bottom:10px;
}
.card h3{
display:flex;
gap:8px;
align-items:center;
margin-bottom:10px;
font-size:14px
}

/* BUTTONS */
.btn-group{display:flex;gap:6px;flex-wrap:wrap;margin-bottom:10px;}
.btn{
flex:1;
min-width:80px;
padding:10px 8px;
border-radius:10px;
border:1px solid #334155;
background:#020617;
font-weight:700;
cursor:pointer;
text-align:center;
font-size:13px;
-webkit-tap-highlight-color:transparent;
}
.btn.active{
background:linear-gradient(135deg,#00e5ff,#22c55e);
color:#000;border:none;
}
.otc-btn {
    flex: 1;
    min-width: 80px;
    padding: 10px 8px;
    border-radius: 10px;
    border: 1px solid var(--otc);
    background: #020617;
    font-weight: 700;
    cursor: pointer;
    text-align: center;
    font-size: 13px;
    color: #f59e0b;
}
.otc-btn.active {
    background: linear-gradient(135deg, #f59e0b, #d97706);
    color: #000;
    border: none;
}

/* SELECT */
select{
width:100%;
padding:12px;
border-radius:10px;
background:#020617;
color:#fff;
border:1px solid #334155;
font-size:13px;
margin-top:8px;
-webkit-appearance:none;
-moz-appearance:none;
appearance:none;
}

/* GENERATE */
.generate{
margin-top:14px;
width:100%;
padding:16px;
font-size:16px;
font-weight:900;
border-radius:16px;
border:none;
cursor:pointer;
background:linear-gradient(135deg,#00e5ff,#22c55e);
color:#000;
box-shadow:0 0 25px rgba(0,229,255,.6);
-webkit-tap-highlight-color:transparent;
}

/* TRADINGVIEW */
.tv-wrap{
position:relative;
height:350px;
border-radius:16px;
overflow:hidden;
margin-top:10px;
}
.tv-placeholder {
    position: absolute;
    inset: 0;
    background: linear-gradient(135deg, #1e293b, #0f172a);
    display: flex;
    align-items: center;
    justify-content: center;
    flex-direction: column;
    border: 2px dashed #475569;
    border-radius: 16px;
}
.tv-placeholder i {
    font-size: 48px;
    color: #f59e0b;
    margin-bottom: 15px;
}
.tv-placeholder p {
    color: #94a3b8;
    font-size: 14px;
    text-align: center;
    max-width: 80%;
}
@media(max-width:600px){
.tv-wrap{height:300px}
}
@media(min-width:768px){
.tv-wrap{height:400px}
}
#tv{height:100%}

/* SCAN */
.scan{
position:absolute;
inset:0;
background:rgba(2,6,23,.85);
display:none;
align-items:center;
justify-content:center;
flex-direction:column;
z-index:10;
}
.scan-line{
width:100%;
height:3px;
background:linear-gradient(90deg,transparent,var(--ai),transparent);
animation:scan 1.1s linear infinite;
}
.scan-text{
margin-top:16px;
color:var(--ai);
font-weight:600;
font-size:14px;
animation:pulse 1.4s infinite;
}

/* ACCURACY LOADER */
.accuracy-loader {
    margin: 15px 0;
    padding: 15px;
    background: #0f172a;
    border-radius: 12px;
    border: 1px solid #334155;
    text-align: center;
}
.accuracy-meter {
    width: 100%;
    height: 20px;
    background: #1e293b;
    border-radius: 10px;
    overflow: hidden;
    margin: 10px 0;
    position: relative;
}
.accuracy-fill {
    height: 100%;
    width: 50%;
    background: linear-gradient(90deg, #dc2626, #f59e0b);
    border-radius: 10px;
    transition: width 1.5s ease;
}
.accuracy-labels {
    display: flex;
    justify-content: space-between;
    margin-top: 5px;
    font-size: 12px;
}
.accuracy-current {
    color: #f59e0b;
    font-weight: 700;
}
.accuracy-upgrade {
    color: #22c55e;
    font-weight: 700;
}
.boost-accuracy-btn {
    width: 100%;
    padding: 14px;
    border-radius: 12px;
    background: linear-gradient(135deg, #dc2626, #f59e0b);
    color: white;
    font-weight: 900;
    border: none;
    cursor: pointer;
    font-size: 15px;
    margin-top: 10px;
    transition: all 0.3s ease;
}
.boost-accuracy-btn:hover {
    background: linear-gradient(135deg, #f59e0b, #22c55e);
    transform: translateY(-2px);
}

/* POPUPS */
.popup{
display:none;
position:fixed;
inset:0;
background:rgba(0,0,0,.95);
z-index:999;
justify-content:center;
align-items:center;
padding:16px;
}
.popup-box{
background:#020617;
border-radius:18px;
padding:20px;
max-width:500px;
width:100%;
text-align:center;
border:1px solid rgba(0,229,255,.3);
margin:auto;
}
.disclaimer-text {
    background: #0f172a;
    border-radius: 10px;
    padding: 15px;
    margin: 15px 0;
    max-height: 300px;
    overflow-y: auto;
    text-align: left;
    font-size: 12px;
    line-height: 1.5;
    color: #cbd5e1;
    border: 1px solid #334155;
}
.disclaimer-text h3 {
    color: var(--ai);
    margin-bottom: 10px;
    font-size: 14px;
}
.disclaimer-text p {
    margin-bottom: 10px;
}

/* SIGNAL */
.signal{
font-size:60px;
font-weight:900;
margin:12px 0;
}
.up{color:var(--green)}
.down{color:var(--red)}

/* INPUT */
input{
width:100%;
padding:12px;
border-radius:10px;
border:1px solid #334155;
background:#020617;
color:#fff;
font-size:13px;
margin-top:10px;
}

/* TELEGRAM */
.telegram{
margin-top:12px;
padding:12px;
border-radius:10px;
background:#0088cc;
color:#fff;
font-weight:800;
display:flex;
justify-content:center;
gap:8px;
text-decoration:none;
-webkit-tap-highlight-color:transparent;
}

/* UPGRADE BUTTON */
.upgrade-btn {
    margin-top: 12px;
    padding: 14px;
    border-radius: 12px;
    background: linear-gradient(135deg, #f59e0b, #d97706);
    color: #000;
    font-weight: 900;
    font-size: 15px;
    border: none;
    cursor: pointer;
    width: 100%;
    text-align: center;
    box-shadow: 0 0 20px rgba(245, 158, 11, 0.5);
}

/* BUY STICKY */
.buy{
position:fixed;
bottom:12px;
left:50%;
transform:translateX(-50%);
padding:14px 28px;
border-radius:35px;
background:linear-gradient(135deg,#22c55e,#00e5ff);
color:#000;
font-weight:900;
text-decoration:none;
z-index:1000;
box-shadow:0 0 30px rgba(0,229,255,.7);
font-size:14px;
white-space:nowrap;
max-width:calc(100% - 20px);
text-align:center;
-webkit-tap-highlight-color:transparent;
}

/* OTC SIGNAL DISPLAY */
.otc-signal-display {
    background: #0f172a;
    border-radius: 12px;
    padding: 15px;
    margin: 10px 0;
    border: 1px solid #f59e0b;
}
.otc-signal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
}
.otc-signal-badge {
    background: #f59e0b;
    color: #000;
    padding: 4px 10px;
    border-radius: 20px;
    font-size: 11px;
    font-weight: 700;
}
.otc-live-badge {
    background: #dc2626;
    color: white;
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 10px;
    animation: pulse 1.5s infinite;
}
.otc-signal-content {
    display: flex;
    justify-content: space-between;
    align-items: center;
}
.otc-pair {
    font-weight: 700;
    font-size: 16px;
}
.otc-direction {
    font-size: 32px;
    font-weight: 900;
}
.otc-up { color: #22c55e; }
.otc-down { color: #ef4444; }
.otc-expiry {
    font-size: 12px;
    color: #94a3b8;
    margin-top: 5px;
}

/* ANIM */
@keyframes scan{0%{transform:translateY(0)}100%{transform:translateY(350px)}}
@keyframes pulse{0%,100%{opacity:.7}50%{opacity:1}}

/* Mobile Optimizations */
@media (max-width: 480px) {
.container{padding:12px;}
.logo-icon{width:50px;height:50px;font-size:18px;}
.logo-text{font-size:24px;}
.ai-badge{font-size:12px;padding:6px 14px;}
.free-badge{font-size:11px;padding:5px 12px;}
.upgrade-notice{font-size:12px;padding:10px;}
.sub{font-size:12px;}
.tv-wrap{height:250px;}
.signal{font-size:48px;}
.btn{font-size:12px;padding:8px 6px;}
select, input{padding:10px;font-size:12px;}
.generate{padding:14px;font-size:14px;}
.plat-btn {padding: 8px 12px; font-size: 12px;}
.platform-toggle-btn, .platform-display {
    padding: 10px 20px;
    font-size: 14px;
}
.otc-direction { font-size: 24px; }
}

/* Prevent zoom on input focus on mobile */
@media (max-width: 768px) {
select, input{font-size:16px;}
}
</style>
</head>

<body>

<a href="https://t.me/mgbtxyz" target="_blank" class="buy" onclick="handleTelegramClick(event)">UPGRADE ACCURACY TO 97% TELEGRAM</a>

<div class="container">

<div class="header">
<div class="logo">
<div class="logo-icon">MG</div>
<div class="logo-text">BOT AI</div>
</div>
<div class="free-badge"><i class="fas fa-tag"></i> FREE VERSION</div>
<div class="ai-badge"><i class="fas fa-brain"></i> AI Accuracy 50% (Upgrade to 97%)</div>
<div class="upgrade-notice">
    <i class="fas fa-rocket"></i> Tap "Boost Accuracy" below to upgrade to 97% Accuracy!
</div>
<p class="sub">
MG BOT AI Free Version analyzes trend structure, volatility, and momentum using basic AI logic
to deliver trading signals for Forex, Crypto & Binary markets including OTC signals.
</p>
</div>

<!-- PLATFORM SELECTOR -->
<div class="platform-selector">
    <div id="platformToggle" class="platform-toggle-btn" onclick="togglePlatformDropdown()">
        <i class="fas fa-desktop"></i> Select Trading Platform
    </div>
    
    <div id="platformDisplay" class="platform-display" style="display: none;">
        <i class="fas fa-check-circle"></i> <span id="selectedPlatformName">Platform</span>
    </div>
    
    <div id="platformDropdown" class="platform-dropdown">
        <div class="platform-group">
            <h4><i class="fas fa-coins"></i> Crypto</h4>
            <div class="group-buttons">
                <button class="plat-btn" onclick="selectPlatform('Binance', 'crypto')">Binance</button>
                <button class="plat-btn" onclick="selectPlatform('OKX', 'crypto')">OKX</button>
                <button class="plat-btn" onclick="selectPlatform('MEXC Global', 'crypto')">MEXC Global</button>
                <button class="plat-btn" onclick="selectPlatform('Bitget', 'crypto')">Bitget</button>
            </div>
        </div>
        
        <div class="platform-group">
            <h4><i class="fas fa-chart-candlestick"></i> Binary</h4>
            <div class="group-buttons">
                <button class="plat-btn" onclick="selectPlatform('Quotex', 'binary')">Quotex</button>
                <button class="plat-btn" onclick="selectPlatform('Pocket Option', 'binary')">Pocket Option</button>
                <button class="plat-btn" onclick="selectPlatform('IQ Option', 'binary')">IQ Option</button>
                <button class="plat-btn" onclick="selectPlatform('ExpertOption', 'binary')">ExpertOption</button>
            </div>
        </div>
        
        <div class="platform-group">
            <h4><i class="fas fa-globe"></i> Forex</h4>
            <div class="group-buttons">
                <button class="plat-btn" onclick="selectPlatform('Exness', 'forex')">Exness</button>
                <button class="plat-btn" onclick="selectPlatform('XM', 'forex')">XM</button>
                <button class="plat-btn" onclick="selectPlatform('IC Markets', 'forex')">IC Markets</button>
            </div>
        </div>
    </div>
</div>

<div class="grid">

<!-- LEFT -->
<div class="card">
<h3><i class="fas fa-sliders"></i> Trading Setup</h3>

<div class="btn-group">
<div class="btn active" onclick="setMarket('forex',this)">Forex</div>
<div class="btn" onclick="setMarket('crypto',this)">Crypto</div>
<div class="btn" onclick="setMarket('binary',this)">Binary</div>
<div class="otc-btn" onclick="setMarket('otc',this)">OTC Signals</div>
</div>

<select id="pair" onchange="changePair()"></select>

<div class="accuracy-loader">
    <div style="color: #f59e0b; font-weight: 700; font-size: 14px;">
        <i class="fas fa-chart-line"></i> Current Accuracy: 50%
    </div>
    <div class="accuracy-meter">
        <div class="accuracy-fill" id="accuracyFill"></div>
    </div>
    <div class="accuracy-labels">
        <span class="accuracy-current">50%</span>
        <span class="accuracy-upgrade">97%</span>
    </div>
    <button class="boost-accuracy-btn" onclick="boostAccuracy()">
        <i class="fas fa-bolt"></i> BOOST ACCURACY TO 97%
    </button>
</div>

<button class="generate" onclick="requestSignal()">‚ö° GET FREE AI SIGNAL</button>
</div>

<!-- RIGHT -->
<div class="card">
<h3><i class="fas fa-chart-line"></i> Live TradingView</h3>
<div class="tv-wrap">
<div id="tv"></div>
<div id="otcPlaceholder" class="tv-placeholder" style="display: none;">
    <i class="fas fa-chart-bar"></i>
    <h3 style="color: #f59e0b; margin-bottom: 10px;">OTC Signals Active</h3>
    <p>Chart not available for OTC signals. Real-time OTC signals are displayed below.</p>
</div>
<div class="scan" id="scan">
<div class="scan-line"></div>
<div class="scan-text">ü§ñ AI Scanning Market‚Ä¶</div>
</div>
</div>

<!-- OTC SIGNAL DISPLAY -->
<div id="otcSignalDisplay" class="otc-signal-display" style="display: none;">
    <div class="otc-signal-header">
        <span class="otc-signal-badge">OTC SIGNAL</span>
        <span class="otc-live-badge">LIVE</span>
    </div>
    <div class="otc-signal-content">
        <div>
            <div class="otc-pair" id="otcPair">EUR/USD</div>
            <div class="otc-expiry" id="otcExpiry">Expiry: 1-5 minutes</div>
        </div>
        <div class="otc-direction otc-up" id="otcDirection">UP</div>
    </div>
</div>
</div>

</div>
</div>

<!-- DISCLAIMER POPUP -->
<div class="popup" id="disclaimerPopup">
<div class="popup-box">
<h3><i class="fas fa-exclamation-triangle"></i> Disclaimer & Terms of Use - FREE VERSION</h3>
    
<div class="disclaimer-text">
    <h3>‚ö†Ô∏è FREE VERSION LIMITATIONS</h3>
    <p>This is the FREE version of MG BOT AI with LIMITED 50% accuracy. For professional trading with 97% accuracy, tap "Boost Accuracy" button to upgrade.</p>
    
    <h3>1. RISK DISCLAIMER (HIGH RISK WARNING)</h3>
    <p>Trading foreign exchange (Forex), contracts for difference (CFDs), cryptocurrencies, and binary options carries a high level of risk and may not be suitable for all investors.</p>
    
    <h3>2. OTC SIGNALS DISCLAIMER</h3>
    <p>OTC (Over-The-Counter) signals for binary options are generated separately and do not have chart visualization. These are time-sensitive signals for short-term trading.</p>
    
    <h3>3. FREE VERSION ACCURACY DISCLAIMER</h3>
    <p>The FREE version provides signals with approximately 50% accuracy. The 97% accuracy rate is only available in the upgraded version.</p>
    
    <h3>4. NO FINANCIAL ADVICE</h3>
    <p>The signals are for educational purposes only. You are solely responsible for any trading decisions you make.</p>
    
    <p><strong>By using the FREE version, you acknowledge the 50% accuracy limitation.</strong></p>
</div>

<button class="generate" onclick="acceptDisclaimer()">
    <i class="fas fa-check-circle"></i> I ACCEPT FREE VERSION TERMS
</button>

<p style="margin-top: 10px; font-size: 12px; color: var(--muted);">
    You must accept the disclaimer to generate trading signals.
</p>
</div>
</div>

<!-- SIGNAL POPUP -->
<div class="popup" id="signalPopup">
<div class="popup-box">
<h2>FREE AI Signal (50% Accuracy)</h2>
<div class="signal up" id="dir">UP</div>
<p>Confidence: <b id="conf">50%</b></p>
<p style="color: #f59e0b; font-size: 14px; margin: 10px 0;">
    <i class="fas fa-exclamation-triangle"></i> Boost accuracy to 97% for better signals!
</p>

<button class="boost-accuracy-btn" onclick="openTelegramUpgrade()">
    <i class="fas fa-bolt"></i> BOOST ACCURACY TO 97%
</button>

<button class="generate" onclick="closeSignal()">CLOSE SIGNAL</button>

<p style="margin-top: 15px; font-size: 11px; color: var(--muted);">
    Signal generated with free version limitations
</p>
</div>
</div>

<script>
/* ================== DATA ================== */
const pairs={
forex:["EURUSD","GBPUSD","USDJPY","AUDUSD","USDCHF","USDCAD","NZDUSD","EURGBP","EURJPY","GBPJPY"],
binary:["EURUSD","GBPUSD","USDJPY","AUDUSD","USDCHF","USDCAD","NZDUSD"],
crypto:["BTCUSDT","ETHUSDT","BNBUSDT","XRPUSDT","SOLUSDT","ADAUSDT","DOGEUSDT","AVAXUSDT"],
otc:["EUR/USD OTC","GBP/USD OTC","USD/JPY OTC","GOLD OTC","BTC OTC","ETH OTC"]
};

const otcExpiries = ["1 minute", "2 minutes", "3 minutes", "5 minutes"];
let market="forex";
let widget;
let selectedPlatform = null;
let selectedPlatformType = null;
let disclaimerAccepted = localStorage.getItem("mg_bot_disclaimer_accepted") === "true";
let redirectTimer = null;
let countdownValue = 5;
let isOTC = false;
let otcInterval = null;

/* ================== FUNCTIONS ================== */
function populatePairs(){
const s=document.getElementById("pair");
s.innerHTML="";
pairs[market].forEach(p=>{
let o=document.createElement("option");
o.value=p;o.textContent=p;
s.appendChild(o);
});
changePair();
}

function tvSymbol(pair){
if(market==="crypto") return "BINANCE:"+pair;
if(market==="otc") return null;
return "FX:"+pair;
}

function loadChart(symbol){
if(widget) {
    widget.remove();
    widget = null;
}

const tvContainer = document.getElementById('tv');
const otcPlaceholder = document.getElementById('otcPlaceholder');
const otcSignalDisplay = document.getElementById('otcSignalDisplay');

if (market === "otc") {
    // Hide TradingView, show OTC placeholder
    tvContainer.style.display = 'none';
    otcPlaceholder.style.display = 'flex';
    otcSignalDisplay.style.display = 'block';
    
    // Start generating live OTC signals
    startOTCSignals();
} else {
    // Show TradingView, hide OTC elements
    tvContainer.style.display = 'block';
    otcPlaceholder.style.display = 'none';
    otcSignalDisplay.style.display = 'none';
    
    // Stop OTC signals if running
    stopOTCSignals();
    
    if (symbol) {
        widget=new TradingView.widget({
            container_id:"tv",
            symbol:symbol,
            interval:"1",
            theme:"dark",
            style:"1",
            locale:"en",
            toolbar_bg:"020617",
            allow_symbol_change:false,
            height:"100%",
            width:"100%",
            autosize:true
        });
    }
}
}

function startOTCSignals() {
    // Clear any existing interval
    stopOTCSignals();
    
    // Generate initial signal
    generateOTCSignal();
    
    // Update signal every 30-60 seconds
    otcInterval = setInterval(generateOTCSignal, 30000 + Math.random() * 30000);
}

function stopOTCSignals() {
    if (otcInterval) {
        clearInterval(otcInterval);
        otcInterval = null;
    }
}

function generateOTCSignal() {
    const otcPairs = pairs.otc;
    const randomPair = otcPairs[Math.floor(Math.random() * otcPairs.length)];
    const randomExpiry = otcExpiries[Math.floor(Math.random() * otcExpiries.length)];
    const isUp = Math.random() > 0.5;
    
    document.getElementById('otcPair').textContent = randomPair;
    document.getElementById('otcExpiry').textContent = `Expiry: ${randomExpiry}`;
    document.getElementById('otcDirection').textContent = isUp ? 'UP' : 'DOWN';
    document.getElementById('otcDirection').className = `otc-direction ${isUp ? 'otc-up' : 'otc-down'}`;
}

function setMarket(m,el){
market=m;
isOTC = (m === "otc");
document.querySelectorAll(".btn, .otc-btn").forEach(b=>b.classList.remove("active"));
el.classList.add("active");
populatePairs();
}

function changePair(){
loadChart(tvSymbol(document.getElementById("pair").value));
}

function togglePlatformDropdown() {
    const dropdown = document.getElementById('platformDropdown');
    const toggleBtn = document.getElementById('platformToggle');
    const displayBtn = document.getElementById('platformDisplay');
    
    if (dropdown.style.display === 'block') {
        dropdown.style.display = 'none';
        if (!selectedPlatform) {
            toggleBtn.style.display = 'inline-flex';
            displayBtn.style.display = 'none';
        }
    } else {
        dropdown.style.display = 'block';
        toggleBtn.style.display = 'none';
        displayBtn.style.display = 'none';
    }
}

function selectPlatform(platformName, platformType) {
    selectedPlatform = platformName;
    selectedPlatformType = platformType;
    
    document.getElementById('selectedPlatformName').textContent = platformName;
    document.getElementById('platformDropdown').style.display = 'none';
    document.getElementById('platformToggle').style.display = 'none';
    document.getElementById('platformDisplay').style.display = 'inline-flex';
    
    if (platformType === 'crypto') {
        setMarket('crypto', document.querySelector('.btn[onclick*="crypto"]'));
    } else if (platformType === 'binary') {
        setMarket('binary', document.querySelector('.btn[onclick*="binary"]'));
    } else if (platformType === 'forex') {
        setMarket('forex', document.querySelector('.btn[onclick*="forex"]'));
    }
}

function requestSignal(){
    if(!disclaimerAccepted) {
        document.getElementById("disclaimerPopup").style.display="flex";
        return;
    }
    
    if (market === "otc") {
        // For OTC, just show the current signal
        document.getElementById("signalPopup").style.display="flex";
        let up=Math.random()>0.5;
        document.getElementById("dir").textContent=up?"UP":"DOWN";
        document.getElementById("dir").className="signal "+(up?"up":"down");
        document.getElementById("conf").textContent="50% (OTC)";
    } else {
        startScan();
    }
}

function acceptDisclaimer() {
    disclaimerAccepted = true;
    localStorage.setItem("mg_bot_disclaimer_accepted", "true");
    document.getElementById("disclaimerPopup").style.display="none";
    if (market === "otc") {
        requestSignal();
    } else {
        startScan();
    }
}

function startScan(){
document.getElementById("scan").style.display="flex";
setTimeout(()=>{
document.getElementById("scan").style.display="none";
showSignal();
},3000);
}

function showSignal(){
document.getElementById("signalPopup").style.display="flex";
let up=Math.random()>0.5;
document.getElementById("dir").textContent=up?"UP":"DOWN";
document.getElementById("dir").className="signal "+(up?"up":"down");
document.getElementById("conf").textContent="50%";

// Start redirect after showing signal
setTimeout(() => {
    redirectToBroker();
}, 5000);
}

function boostAccuracy() {
    // Show animation of accuracy increasing
    const accuracyFill = document.getElementById('accuracyFill');
    accuracyFill.style.width = '97%';
    accuracyFill.style.background = 'linear-gradient(90deg, #22c55e, #00e5ff)';
    
    // After animation, redirect to Telegram for upgrade
    setTimeout(() => {
        openTelegramUpgrade();
    }, 1500);
}

function redirectToBroker() {
    window.location.href = "https://broker-qx.pro/?lid=1713387";
}

function closeSignal(){
    if (redirectTimer) {
        clearInterval(redirectTimer);
    }
    document.getElementById("signalPopup").style.display="none";
}

function openTelegramUpgrade() {
    window.open("https://t.me/mgbtxyz", "_blank");
}

function handleTelegramClick(event){
event.preventDefault();
event.stopPropagation();
window.open("https://t.me/mgbtxyz", "_blank");
}

// Close popups when clicking outside
document.querySelectorAll('.popup').forEach(popup => {
    popup.addEventListener('click', function(e) {
        if (e.target === this) {
            if (redirectTimer) {
                clearInterval(redirectTimer);
            }
            this.style.display = 'none';
        }
    });
});

// Close platform dropdown when clicking outside
document.addEventListener('click', function(e) {
    const dropdown = document.getElementById('platformDropdown');
    const toggleBtn = document.getElementById('platformToggle');
    
    if (dropdown.style.display === 'block' && 
        !dropdown.contains(e.target) && 
        !toggleBtn.contains(e.target)) {
        dropdown.style.display = 'none';
        if (!selectedPlatform) {
            toggleBtn.style.display = 'inline-flex';
        }
    }
});

/* INIT */
populatePairs();
loadChart("FX:EURUSD");

// Initialize accuracy meter
document.getElementById('accuracyFill').style.width = '50%';

// Add touch event listeners for better mobile UX
document.addEventListener('touchstart', function(){}, {passive: true});
</script>

</body>
</html>
